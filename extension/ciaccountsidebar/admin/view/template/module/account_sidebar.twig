{{ header }}{{ column_left }}
<div id="content">
  <div class="page-header">
    <div class="container-fluid">
      <div class="float-end">
        <button type="submit" form="form-account-sidebar" data-bs-toggle="tooltip" title="{{ button_save }}" class="btn btn-primary"><i class="fa fa-save"></i></button>
        <a href="{{ cancel }}" data-bs-toggle="tooltip" title="{{ button_cancel }}" class="btn btn-default"><i class="fa fa-reply"></i></a></div>
      <h1>{{ heading_title }}</h1>
      <ol class="breadcrumb">
        {% for breadcrumb in breadcrumbs %}
          <li class="breadcrumb-item"><a href="{{ breadcrumb.href }}">{{ breadcrumb.text }}</a></li>
        {% endfor %}
      </ol>
    </div>
  </div>
  <div class="container-fluid">
    {% if error_warning %}
    <div class="alert alert-danger alert-dismissible fade show" role="alert"><i class="fa fa-exclamation-circle"></i> {{ error_warning }}
      <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>
    {% endif %}

    {% if success %}
    <div class="alert alert-success alert-dismissible fade show" role="alert"><i class="fa fa-check-circle"></i> {{ success }}
      <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>
    {% endif %}

    <div class="card">
      <div class="card-header"><i class="fas fa-pencil-alt"></i> {{ text_edit }}</div>
      <div class="card-body">
        <form action="{{ action }}" method="post" enctype="multipart/form-data" id="form-account-sidebar" class="form-horizontal">
        <ul class="nav nav-tabs">
          <li class="nav-item"><a href="#tab-general" data-bs-toggle="tab" class="nav-link active"><i class="fa fa-cogs"></i> {{ tab_general }}</a></li>
          <li class="nav-item"><a href="#tab-accountsidebar-titles" data-bs-toggle="tab" class="nav-link"><i class="fa fa-columns"></i> {{ tab_customer_title }}</a></li>
        </ul>
        <div class="tab-content">
          <div class="tab-pane active" id="tab-general">
            <div class="row mb-3">
              <label class="col-sm-2 col-form-label" for="input-status">{{ entry_status }}</label>
              <div class="col-sm-8">
                <select name="module_account_sidebar_status" id="input-status" class="form-select">
                  {% if module_account_sidebar_status %}
                  <option value="1" selected="selected">{{ text_enabled }}</option>
                  <option value="0">{{ text_disabled }}</option>
                  {% else %}
                  <option value="1">{{ text_enabled }}</option>
                  <option value="0" selected="selected">{{ text_disabled }}</option>
                  {% endif %}
                </select>
              </div>
            </div>
            <div class="row mb-3">
              <label class="col-sm-2 col-form-label" for="input-module_account_sidebar-titlebgcolor">{{ entry_title_bgcolor }}</label>
              <div class="col-sm-8">
                <input type="text" name="module_account_sidebar_titlebgcolor" value="{{ module_account_sidebar_titlebgcolor }}" placeholder="{{ entry_title_bgcolor }}" id="input-module_account_sidebar-titlebgcolor" class="form-control color-picker" />
                <div class="form-text">{{ help_title_bgcolor }}</div>
              </div>
              <div class="col-sm-2">
                <div class="preview"></div>
              </div>
            </div>
            <div class="row mb-3">
              <label class="col-sm-2 col-form-label" for="input-module_account_sidebar-titlecolor">{{ entry_title_color }}</label>
              <div class="col-sm-8">
                <input type="text" name="module_account_sidebar_titlecolor" value="{{ module_account_sidebar_titlecolor }}" placeholder="{{ entry_title_color }}" id="input-module_account_sidebar-titlecolor" class="form-control color-picker" />
                <div class="form-text">{{ help_title_color }}</div>
              </div>
              <div class="col-sm-2">
                <div class="preview"></div>
              </div>
            </div>
            <div class="row mb-3">
              <label class="col-sm-2 col-form-label" for="input-module_account_sidebar-linkbgcolor">{{ entry_link_bgcolor }}</label>
              <div class="col-sm-8">
                <input type="text" name="module_account_sidebar_linkbgcolor" value="{{ module_account_sidebar_linkbgcolor }}" placeholder="{{ entry_link_bgcolor }}" id="input-module_account_sidebar-linkbgcolor" class="form-control color-picker" />
                <div class="form-text">{{ help_link_bgcolor }}</div>
              </div>
              <div class="col-sm-2">
                <div class="preview"></div>
              </div>
            </div>
            <div class="row mb-3">
              <label class="col-sm-2 col-form-label" for="input-module_account_sidebar-linkcolor">{{ entry_link_color }}</label>
              <div class="col-sm-8">
                <input type="text" name="module_account_sidebar_linkcolor" value="{{ module_account_sidebar_linkcolor }}" placeholder="{{ entry_link_color }}" id="input-module_account_sidebar-linkcolor" class="form-control color-picker" />
                <div class="form-text">{{ help_link_color }}</div>
              </div>
              <div class="col-sm-2">
                <div class="preview"></div>
              </div>
            </div>
            <div class="row mb-3">
              <label class="col-sm-2 col-form-label" for="input-module_account_sidebar-hoverbgcolor">{{ entry_hover_bgcolor }}</label>
              <div class="col-sm-8">
                <input type="text" name="module_account_sidebar_hoverbgcolor" value="{{ module_account_sidebar_hoverbgcolor }}" placeholder="{{ entry_hover_bgcolor }}" id="input-module_account_sidebar-hoverbgcolor" class="form-control color-picker" />
                <div class="form-text">{{ help_hover_bgcolor }}</div>
              </div>
              <div class="col-sm-2">
                <div class="preview"></div>
              </div>
            </div>
            <div class="row mb-3">
              <label class="col-sm-2 col-form-label" for="input-module_account_sidebar-hovercolor">{{ entry_hover_color }}</label>
              <div class="col-sm-8">
                <input type="text" name="module_account_sidebar_hovercolor" value="{{ module_account_sidebar_hovercolor }}" placeholder="{{ entry_hover_color }}" id="input-module_account_sidebar-hovercolor" class="form-control color-picker" />
                <div class="form-text">{{ help_hover_color }}</div>
              </div>
              <div class="col-sm-2">
                <div class="preview"></div>
              </div>
            </div>
          </div>
          <div class="tab-pane" id="tab-accountsidebar-titles">
            <div class="row align-items-start">
              <div class="nav nav-pills col-sm-4 col-xs-12 col-md-3" id="titles" role="tablist" aria-orientation="vertical">
                {% set title_row = 0 %}
                  {% for title in titles %}
                  {% set counter = title_row + 1 %}
                  <button type="button" class="nav-link dy-link {% if loop.first %}active{% endif %}" data-bs-toggle="pill" id="tab-title{{ title_row }}-tab" data-bs-target="#tab-title{{ title_row }}" role="tab" aria-controls="v-pills-home" aria-selected="true" data-bs-toggle="tab"><i class="fa fa-minus-circle" onclick="$('button[data-bs-target=\'#tab-title{{ title_row }}\']').remove(); $('#tab-title{{ title_row }}').remove(); $('#titles .dy-link:first-child').trigger('click');"></i> {{ title.description[config_language_id].title ? title.description[config_language_id].title : tab_title ~ '-' ~ counter }} <i class="fa fa-arrows pull-right" aria-hidden="true"></i></button>
                  {% set title_row = title_row + 1 %}
                  {% endfor %}
                  <button type="button" class="nav-link addcustomlink" onclick="addTitle();"><i class="fa fa-plus-circle" aria-hidden="true"></i> {{ button_add_title }}</button>
              </div>
              <div class="tab-content col-sm-8 col-xs-12 col-md-9" id="titlesContent">
                {% set title_row = 0 %}
                {% set module_account_sidebar_link_title_row = 0 %}
                {% for title_key, title in titles %}
                <div class="tab-pane fade {% if loop.first %}show active{% endif %}" role="tabpanel" aria-labelledby="tab-title{{ title_row }}-tab" id="tab-title{{ title_row }}">
                  <div class="row mb-3">
                    <label class="col-sm-2 col-form-label">{{ entry_status }}</label>
                    <div class="col-sm-10">
                      <select name="module_account_sidebar_title[{{ title_row }}][status]" class="form-select title-status" rel="{{ title_row }}">
                        {% if title.status %}
                        <option value="1" selected="selected">{{ text_enabled }}</option>
                        <option value="0">{{ text_disabled }}</option>
                        {% else %}
                        <option value="1">{{ text_enabled }}</option>
                        <option value="0" selected="selected">{{ text_disabled }}</option>
                        {% endif %}
                      </select>
                    </div>
                  </div>
                  <div class="row mb-3 hide">
                    <label class="col-sm-2 col-form-label">{{ entry_sort_order }}</label>
                    <div class="col-sm-10">
                      <input type="text" name="module_account_sidebar_title[{{ title_row }}][sort_order]"  value="{{ title.sort_order }}" class="form-control title-sortorder" />
                      <div class="form-text">{{ help_sort_order }}</div>
                    </div>
                  </div>
                  <div class="title-group">
                    <ul class="nav nav-tabs" id="title-language{{ title_row }}">
                      {% for language in languages %}
                      <li class="nav-item"><a href="#title-language{{ title_row }}-{{ language.language_id }}" data-bs-toggle="tab" class="nav-link{% if loop.first %} active{% endif %}">
                      <img src="language/{{ language.code }}/{{ language.code }}.png" title="{{ language.name }}" /> {{ language.name }}
                      </a></li>
                      {% endfor %}
                    </ul>
                    <div class="tab-content">
                      {% for language in languages %}
                      <div class="tab-pane{% if loop.first %} active{% endif %}" id="title-language{{ title_row }}-{{ language.language_id }}">
                        <div class="row mb-3 required">
                          <label class="col-sm-2 col-form-label">{{ entry_title }}</label>
                          <div class="col-sm-10">
                            <input type="text" name="module_account_sidebar_title[{{ title_row }}][description][{{ language.language_id }}][title]" value="{{ title.description[language.language_id].title ? title.description[language.language_id].title }}" placeholder="{{ entry_title }}" class="form-control" />
                            <div class="form-text">{{ help_title }}</div>
                            {% if error_title[title_key][language.language_id] %}
                              <div class="text-danger">{{ error_title[title_key][language.language_id] }}</div>
                            {% endif %}
                          </div>
                        </div>
                      </div>
                      {% endfor %}
                    </div>
                  </div>
                    <fieldset id="link-values{{ title_row }}">
                      <legend>{{ text_value_setting }}</legend>
                      <table id="accountsidebarlink-title{{ title_row }}" class="table table-bordered table-hover">
                        <thead>
                          <tr>
                            <td class="text-left required">{{ entry_link_title }}</td>
                            <td class="text-left">{{ entry_link }}</td>
                            <td class="text-left">{{ entry_iconclass }}</td>
                            <td class="text-left">{{ entry_logged }}</td>
                            <td class="text-right hide">{{ entry_sort_order }}</td>
                            <td class="text-right">{{ entry_action }}</td>
                          </tr>
                        </thead>
                        <tbody>
                          {% if title.link_title %}
                          {% for link_key, module_account_sidebar_link_title in title.link_title %}
                          <tr id="accountsidebarlink-title-row{{ title_row }}-{{ module_account_sidebar_link_title_row }}">
                            <td class="text-left">
                              <input type="hidden" name="module_account_sidebar_title[{{ title_row }}][link_title][{{ module_account_sidebar_link_title_row }}][module_account_sidebar_link_title_id]" value="{{ module_account_sidebar_link_title.module_account_sidebar_link_title_id }}" />
                              {% for language in languages %}
                              <div class="input-group"><span class="input-group-text">
                                <img src="language/{{ language.code }}/{{ language.code }}.png" title="{{ language.name }}" /></span>
                                <input type="text" name="module_account_sidebar_title[{{ title_row }}][link_title][{{ module_account_sidebar_link_title_row }}][module_account_sidebar_link_title_description][{{ language.language_id }}][name]" value="{{ module_account_sidebar_link_title.module_account_sidebar_link_title_description[language.language_id].name ? module_account_sidebar_link_title.module_account_sidebar_link_title_description[language.language_id].name }}" placeholder="{{ entry_link_title }}" class="form-control" />
                                {% if error_link_title[title_row][link_key][language.language_id] %}
                                <div class="text-danger">{{ error_link_title[title_row][link_key][language.language_id] }}</div>
                                {% endif %}
                              </div>
                              {% endfor %}</td>
                            <td class="text-left"><input type="text" name="module_account_sidebar_title[{{ title_row }}][link_title][{{ module_account_sidebar_link_title_row }}][link]" value="{{ module_account_sidebar_link_title.link }}" class="form-control" /></td>
                            <td class="text-left"><input type="text" name="module_account_sidebar_title[{{ title_row }}][link_title][{{ module_account_sidebar_link_title_row }}][iconclass]" value="{{ module_account_sidebar_link_title.iconclass }}" class="form-control" /></td>
                            <td class="text-left">
                              <select name="module_account_sidebar_title[{{ title_row }}][link_title][{{ module_account_sidebar_link_title_row }}][logged]" id="input-logged" class="form-select">
                                <option value="2" {% if module_account_sidebar_link_title.logged == '2' %} selected="selected" {% endif %} >{{ text_both }}</option>
                                <option value="1" {% if module_account_sidebar_link_title.logged == '1' %}  selected="selected" {% endif %} >{{ text_yes }}</option>
                                <option value="0" {% if module_account_sidebar_link_title.logged == '0' %} selected="selected" {% endif %} >{{ text_no }}</option>
                                <option value="3" {% if module_account_sidebar_link_title.logged == '3' %} selected="selected" {% endif %} >{{ text_affiliate_register }}</option>
                                <option value="4" {% if module_account_sidebar_link_title.logged == '4' %} selected="selected" {% endif %} >{{ text_affiliate_logged }}</option>
                              </select>
                            </td>
                            <td class="text-right hide"><input type="text" name="module_account_sidebar_title[{{ title_row }}][link_title][{{ module_account_sidebar_link_title_row }}][sort_order]" value="{{ module_account_sidebar_link_title.sort_order }}" class="form-control link-sortorder" /></td>
                            <td class="text-right"><button type="button" onclick="$('#accountsidebarlink-title-row{{ title_row }}-{{ module_account_sidebar_link_title_row }}').remove();" data-bs-toggle="tooltip" title="{{ button_remove }}" class="btn btn-danger"><i class="fa fa-minus-circle"></i></button></td>
                          </tr>
                          {% set module_account_sidebar_link_title_row = module_account_sidebar_link_title_row + 1 %}
                          {% endfor %}
                          {% endif %}
                        </tbody>
                        <tfoot>
                          <tr>
                            <td colspan="5"></td>
                            <td class="text-right"><button type="button" onclick="addLinkTitle('{{ title_row }}');" data-bs-toggle="tooltip" title="{{ button_link_title_add }}" class="btn  btn-primary"><i class="fa fa-plus-circle"></i></button></td>
                          </tr>
                        </tfoot>
                      </table>
                    </fieldset>
                </div>
                {% set title_row = title_row + 1 %}
              {% endfor %}
              </div>
            </div>
          </div>
        </div>
        </form>
      </div>
    </div>
  </div>
  <script type="text/javascript"><!--
  {% set j = 0 %}
  {% for key, title in titles %}
  // $('#title-language{{ j }} li:first-child a').tab('show');
  {% set j = j + 1 %}
  {% endfor %}
//--></script>
<script type="text/javascript"><!--
var title_row = {{ title_row }};
console.log(title_row);
function addTitle() {
  html = '<div class="tab-pane fade" id="tab-title' + title_row + '" role="tabpanel" aria-labelledby="tab-title' + title_row + '-tab" id="tab-title' + title_row + '">';
      html += '<div class="row mb-3">';
        html += '<label class="col-sm-2 col-form-label">{{ entry_status }}</label>';
        html += '<div class="col-sm-10">';
          html += '<select name="module_account_sidebar_title[' + title_row + '][status]" class="form-select title-status" rel="' + title_row + '">';
            html += '<option value="1" selected="selected">{{ text_enabled }}</option>';
            html += '<option value="0">{{ text_disabled }}</option>';
          html += '</select>';
        html += '</div>';
      html += '</div>';
      html += '<div class="row mb-3 hide">';
        html += '<label class="col-sm-2 col-form-label">{{ entry_sort_order }}</label>';
        html += '<div class="col-sm-10">';
          html += '<input type="text" name="module_account_sidebar_title[' + title_row + '][sort_order]"  value="' + (title_row + 1) + '" class="form-control title-sortorder" /><div class="form-text">{{ help_sort_order }}</div>';
        html += '</div>';
      html += '</div>';
      html += '<div class="title-group">';
        html += '<ul class="nav nav-tabs" id="title-language' + title_row + '">';
          {% for language in languages %}
          html += '<li class="nav-item"><a href="#title-language' + title_row + '-{{ language.language_id }}" data-bs-toggle="tab" class="nav-link{% if loop.first %} active{% endif %}">';
          html += '<img src="language/{{ language.code }}/{{ language.code }}.png" title="{{ language.name }}" /> {{ language.name }}' ;
         html += ' </a></li>';
          {% endfor %}
        html += '</ul>';
        html += '<div class="tab-content">';
          {% for language in languages %}
          html += '<div class="tab-pane {% if loop.first %} active{% endif %}" id="title-language' + title_row + '-{{ language.language_id }}">';
            html += '<div class="row mb-3 required">';
              html += '<label class="col-sm-2 col-form-label">{{ entry_title }}</label>';
              html += '<div class="col-sm-10">';
                html += '<input type="text" name="module_account_sidebar_title[' + title_row + '][description][{{ language.language_id }}][title]" value="" placeholder="{{ entry_title }}" class="form-control" /><div class="form-text">{{ help_title }}</div>';
              html += '</div>';
            html += '</div>';
           html += '</div>';
          {% endfor %}
        html += '</div>';
      html += '</div>';
    html += '<fieldset id="link-values' + title_row + '">';
      html += '<legend>{{ text_value_setting }}</legend>';
        html += '<table id="accountsidebarlink-title' + title_row + '" class="table table-striped table-bordered table-hover">';
          html += '<thead>';
            html += '<tr>';
              html += '<td class="text-left required">{{ entry_link_title }}</td>';
              html += '<td class="text-left">{{ entry_link }}</td>';
              html += '<td class="text-left">{{ entry_iconclass }}</td>';
              html += '<td class="text-left">{{ entry_logged }}</td>';
              html += '<td class="text-right hide">{{ entry_sort_order }}</td>';
              html += '<td class="text-right">{{ entry_action }}</td>';
            html += '</tr>';
          html += '</thead>';
          html += '<tbody>';
          html += '</tbody>';
          html += '<tfoot>';
            html += '<tr>';
              html += '<td colspan="5"></td>';
              html += '<td class="text-right"><button type="button" onclick="addLinkTitle(' + title_row + ');" data-bs-toggle="tooltip" title="{{ button_link_title_add }}" class="btn btn-primary"><i class="fa fa-plus-circle"></i></button></td>';
            html += '</tr>';
          html += '</tfoot>';
        html += '</table>';
    html += '</fieldset>';
  html += '</div>';

  $('#tab-accountsidebar-titles #titlesContent').append(html);

  $('.addcustomlink').before('<button type="button" class="nav-link dy-link" data-bs-toggle="pill" id="tab-title' + title_row + '-tab" data-bs-target="#tab-title' + title_row + '" role="tab" aria-controls="v-pills-home" aria-selected="true" data-bs-toggle="tab"><i class="fa fa-minus-circle" onclick="$(\'button[data-bs-target=\\\'#tab-title' + title_row + '\\\']\').remove(); $(\'#tab-title' + title_row + '\').remove(); $(\'#titles .dy-link:first-child\').trigger(\'click\');"></i> {{ tab_title }}-'+ parseInt((title_row + 1))  +' <i class="fa fa-arrows pull-right" aria-hidden="true"></i></button>');

  // $('#titles a[href=\'#tab-title' + title_row + '\']').tab('show');

  // $('#title-language'+ title_row +' a:first').tab('show');

  $('#tab-title' + title_row + '-tab').trigger('click');

    var firstTabEl = document.querySelector('[data-bs-target="#tab-title' + title_row + '"]');
    var firstTab = new bootstrap.Tab(firstTabEl);
    firstTab.show();

    addLinkTitle(title_row);

  title_row++;
}
//--></script>
<script type="text/javascript"><!--
var module_account_sidebar_link_title_row = '{{ module_account_sidebar_link_title_row ? module_account_sidebar_link_title_row : 0 }}';

function addLinkTitle(title_row) {
  html  = '<tr id="accountsidebarlink-title-row' + title_row + '-' + module_account_sidebar_link_title_row + '">';
    html += '  <td class="text-left"><input type="hidden" name="module_account_sidebar_title[' + title_row + '][link_title][' + module_account_sidebar_link_title_row + '][module_account_sidebar_link_title_id]" value="" />';
  {% for language in languages %}
  html += '    <div class="input-group">';
  html += '      <span class="input-group-text">';
  html += '<img src="language/{{ language.code }}/{{ language.code }}.png" title="{{ language.name }}" />';
  html += '</span><input type="text" name="module_account_sidebar_title[' + title_row + '][link_title][' + module_account_sidebar_link_title_row + '][module_account_sidebar_link_title_description][{{ language.language_id }}][name]" value="" placeholder="{{ entry_link_title }}" class="form-control" />';
    html += '    </div>';
  {% endfor %}
  html += '  </td>';
  html += '  <td class="text-left"><input type="text" name="module_account_sidebar_title[' + title_row + '][link_title][' + module_account_sidebar_link_title_row + '][link]" value="" placeholder="{{ entry_link }}" class="form-control" /></td>';
  html += '  <td class="text-left"><input type="text" name="module_account_sidebar_title[' + title_row + '][link_title][' + module_account_sidebar_link_title_row + '][iconclass]" value="" placeholder="{{ entry_iconclass }}" class="form-control" /></td>';
  html += '  <td class="text-left">';
   html += '  <select name="module_account_sidebar_title[' + title_row + '][link_title][' + module_account_sidebar_link_title_row + '][logged]" id="input-logged" class="form-select">';
     html += ' <option value="2">{{ text_both }}</option>';
     html += '  <option value="1">{{ text_yes }}</option>';
      html += '  <option value="0">{{ text_no }}</option>';
      html += '  <option value="3">{{ text_affiliate_register }}</option>';
      html += '  <option value="4">{{ text_affiliate_logged }}</option>';
     html += '   </select>';
   html += '    </td>';
  html += '  <td class="text-right hide"><input type="text" name="module_account_sidebar_title[' + title_row + '][link_title][' + module_account_sidebar_link_title_row + '][sort_order]" value="" placeholder="{{ entry_sort_order }}" class="form-control link-sortorder" /></td>';
  html += '  <td class="text-right"><button type="button" onclick="$(\'#accountsidebarlink-title-row' + title_row + '-' + module_account_sidebar_link_title_row + '\').remove();" data-bs-toggle="tooltip" title="{{ button_remove }}" class="btn btn-danger"><i class="fa fa-minus-circle"></i></button></td>';
  html += '</tr>';

  $('#accountsidebarlink-title' + title_row + ' tbody').append(html);

  module_account_sidebar_link_title_row++;
}
//--></script>
 <script type="text/javascript">
  var element = null;
  $('.color-picker').ColorPicker({
    curr : '',
    onShow: function (colpkr) {
      $(colpkr).fadeIn(500);
      return false;
    },
    onHide: function (colpkr) {
      $(colpkr).fadeOut(500);
    return false;
    },
    onSubmit: function(hsb, hex, rgb, el) {
      $(el).val('#'+hex);
      $(el).ColorPickerHide();
    },
    onBeforeShow: function () {
      $(this).ColorPickerSetColor(this.value);
    },
    onChange: function (hsb, hex, rgb) {
      element.curr.parent().next().find('.preview').css('background', '#' + hex);
      element.curr.val('#'+hex);
    }
  }).bind('keyup', function(){
    $(this).ColorPickerSetColor(this.value);
  }).click(function(){
    element = this;
    element.curr = $(this);
  });

  $.each($('.color-picker'),function(key,value) {
    $(this).parent().next().find('.preview').css({'background': $(this).val()});
  });
</script>
<style type="text/css">
  .preview { width: 45px; height: 35px; border: 1px solid #ColorPickerSetColorc;  }
  .nav-pills button {
    width: 100%;
    text-align: left;
    padding: 1rem 1rem;
  }

</style>
</div>
{{ footer }}